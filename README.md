# Цель проекта: 

Реализовать считывание финансовых операций из CSV- и XLSX-файлов.
Создать отдельный модуль для новых функций.
Реализовать функцию для считывания финансовых операций из CSV.
Реализовать функцию для считывания финансовых операций из Excel.
Функции для считывания финансовых операций принимают путь к файлу в качестве аргумента.
Функции для считывания финансовых операций выдают список словарей с транзакциями.


# Реализовано ранее:

Созданы логгеры для перечисленных модулей: masks, utils.
Реализована запись логов в файл. 
Логи записываются в папку logs в корне проекта. 
Файлы логов имеют расширение .log.
Формат записи лога в файл включает метку времени, название модуля, 
уровень серьезности и сообщение, описывающее событие или ошибку, которые произошли.
Лог перезаписывается при каждом запуске приложения.

Логирование настроено с помощью декоратора **logged** в модуле **decorate_logs.py**

## Создан модуль **utils** для организации работы с файлами

### Функция read_json_list
Принимает на вход путь до JSON-файла.
Возвращает список словарей с данными о финансовых транзакциях. 
Если файл пустой, содержит не список или не найден, функция возвращает пустой список. 

Файл с данными о финансовых транзакциях "operations.json" находится в директорию data/ в корне проекта.

## Создан модуль **generators** для работы с транзакциями

### Функция **get_amount** 
Принимает на вход транзакции.
Возвращает сумму транзакции (amount) в рублях, тип данных — float.
Если транзакция была в USD или EUR, происходит обращение к внешнему API для получения текущего курса валют.

## Создан модуль **external_api** для работы с внешними источниками данных

### Функция **get_converted_amount**
Принимает сумму и символ валюты из которой требуется конвертации в рубли.
Возвращает сумму в рублях, эквивалентную принятой, в указанной валюте, сумме.

## Создан модуль decorators, который будет использоваться для размещения декораторов:

### Декоратор log 

Записывает лог работы функции и ее результат как в файл, так и в консоль.
Принимает необязательный аргумент **filename**, определяющий имя файла, в который будут записываться логи.
Если **filename** не задан, то логи выводятся в консоль.
Если вызов функции закончился ошибкой, записывается сообщение об ошибке и входные параметры функции.
Ожидаемый вывод в лог-файл **mylog.txt** при успешном выполнении: "my_function ok"
Ожидаемый вывод при ошибке: "my_function error: тип ошибки. Inputs: (1, 2), {}", где тип ошибки заменяется на текст ошибки.


## Создан модуль generators, который будет содержать функции для работы с массивами транзакций:

### Функция filter_by_currency

Принимает на вход список словарей, представляющих транзакции.
Возвращает итератор, который поочередно выдает транзакции, где валюта операции соответствует заданной (например, USD).

### Функция transaction_descriptions

Принимает на вход список словарей, представляющих транзакции.
Возвращает описание каждой операции по очереди.

### Функция card_number_generator

Генерирует номера банковских карт в формате "XXXX XXXX XXXX XXXX", где X — цифра номера карты.
Может сгенерировать номера карт в заданном диапазоне от 0000 0000 0000 0001 до 9999 9999 9999 9999.
Принимает начальное и конечное значения для генерации диапазона номеров.


## Установка
Клонируйте репозиторий: `git clone git@github.com:riga1897/prj007.git`

Перейдите в папку с проектом `cd prj012`

Установите зависимости: `pip install -r requirements.txt`

## Использование
Проект выполняется запуском файла main.py

### Конфигурирование

Задание начальных данных и необходимых параметров выполняется в файле main.py


## Тестирование

### Модуль masks
#### Функция get_mask_card_number

Тестирование правильности маскирования номера карты.
Проверка работы функции на различных входных форматах номеров карт, включая граничные случаи и нестандартные длины номеров.
Проверка, что функция корректно обрабатывает входные строки, где отсутствует номер карты.

#### Функция get_mask_account

Тестирование правильности маскирования номера счета.
Проверка работы функции с различными форматами и длинами номеров счетов.
Проверка, что функция корректно обрабатывает входные данные, где номер счета меньше ожидаемой длины.


### Модуль widget
#### Функция mask_account_card

Тесты для проверки, что функция корректно распознает и применяет нужный тип маскировки в зависимости от типа входных данных (карта или счет).
Параметризованные тесты с разными типами карт и счетов для проверки универсальности функции.
Тестирование функции на обработку некорректных входных данных и проверка ее устойчивости к ошибкам.

#### Функция get_date

Тестирование правильности преобразования даты.
Проверка работы функции на различных входных форматах даты, включая граничные случаи и нестандартные строки с датами.
Проверка, что функция корректно обрабатывает входные строки, где отсутствует дата.


### Модуль processing

#### Функция filter_by_state

Тестирование фильтрации списка словарей по заданному статусу state.
Проверка работы функции при отсутствии словарей с указанным статусом state в списке.
Параметризация тестов для различных возможных значений статуса state.

#### Функция sort_by_date

Тестирование сортировки списка словарей по датам в порядке убывания и возрастания.
Проверка корректности сортировки при одинаковых датах.
Тесты на работу функции с некорректными или нестандартными форматами дат.
Общие аспекты тестирования

### Модуль generators

#### Функция filter_by_currency

Тестирование фильтра транзакции по заданной валюте.
Проверка, что корректности обработки случаев, когда транзакции в заданной валюте отсутствуют.
Проверка, что функция не завершается ошибкой при обработке пустого списка или списка без соответствующих валютных операций.

#### Функция transaction_descriptions

Тестирование правильности обработки описаний для каждой транзакции.
Проверка работы функции с различным количеством входных транзакций, включая пустой список.

#### Функция card_number_generator

Тестирование правильной генерации номеров карт в заданном диапазоне.
Проверка корректности форматирования номеров карт.
Проверка, что генератор корректно обрабатывает крайние значения диапазона и правильно завершает генерацию.

#### Функция get_amount
Тестирование правильного отображения сумм транзакций
Проверка корректной конвертации сумм, указанных в валюте, отличной от руб.

### Модуль decorators

#### Декоратор log

Тестирование покрывает различные сценарии использования декоратора, включая успешное выполнение функций и обработку исключений.


### Модуль utils

#### Функция get_project_root

Тестирование формирования имени, пути к файлу и проверки наличия файла по заданному пути.

#### Функция read_json_list

Тестирование корректного получения из JSON файла списка, получения данных, не являющихся списком.
Тестирование возвращения пустого списка, если файл содержит неверно сформированные данные или если файл не найден.


### Модуль external_api

#### Функция get_converted_amount

Тестирование получения данных о курсе валют с сайта.
Тестирование корректной обработки ошибки получения данных

### Модуль getfile

#### Функция **read_from_csv**

Тестирование корректного получения списка из CSV файла.
Тестирование возвращения пустого списка, если файл CSV не найден.
Тест возвращения пустого списка, если файл CSV содержит неверные данные.

#### Функция **read_from_xlsx**

Тестирование корректного получения списка из XLSX файла.
Тестирование возвращения пустого списка, если файл XLSX не найден.
Тест возвращения пустого списка, если файл XLSX содержит неверные данные.


### Фикстуры. 

Для всех тестов созданы фикстуры, которые предоставят тестовые данные для списков словарей, включая различные случаи и комбинации state и date.


### Покрытие тестами. 
Все ветви кода и исключения, которые могут быть сгенерированы функциями, тестируются.
